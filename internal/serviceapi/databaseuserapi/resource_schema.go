// Code generated by terraform-provider-mongodbatlas using `make generate-resource`. DO NOT EDIT.

package databaseuserapi

import (
	"context"

	"github.com/hashicorp/terraform-plugin-framework/resource/schema"
	"github.com/hashicorp/terraform-plugin-framework/types"
	"github.com/mongodb/terraform-provider-mongodbatlas/internal/common/autogen/customtypes"
)

func ResourceSchema(ctx context.Context) schema.Schema {
	return schema.Schema{
		Attributes: map[string]schema.Attribute{
			"aws_iamtype": schema.StringAttribute{
				Computed:            true,
				Optional:            true,
				MarkdownDescription: "Human-readable label that indicates whether the new database user authenticates with the Amazon Web Services (AWS) Identity and Access Management (IAM) credentials associated with the user or the user's role.",
			},
			"database_name": schema.StringAttribute{
				Computed:            true,
				Optional:            true,
				MarkdownDescription: "The database against which the database user authenticates. Database users must provide both a username and authentication database to log into MongoDB. If the user authenticates with AWS IAM, x.509, LDAP, or OIDC Workload this value should be `$external`. If the user authenticates with SCRAM-SHA or OIDC Workforce, this value should be `admin`.",
			},
			"delete_after_date": schema.StringAttribute{
				Optional:            true,
				MarkdownDescription: "Date and time when MongoDB Cloud deletes the user. This parameter expresses its value in the ISO 8601 timestamp format in UTC and can include the time zone designation. You must specify a future date that falls within one week of making the Application Programming Interface (API) request.",
			},
			"description": schema.StringAttribute{
				Optional:            true,
				MarkdownDescription: "Description of this database user.",
			},
			"group_id": schema.StringAttribute{
				Required:            true,
				MarkdownDescription: "Unique 24-hexadecimal digit string that identifies your project. Use the [/groups](#tag/Projects/operation/listProjects) endpoint to retrieve all projects to which the authenticated user has access.\n\n**NOTE**: Groups and projects are synonymous terms. Your group id is the same as your project id. For existing groups, your group/project id remains the same. The resource and corresponding endpoints use the term groups.",
			},
			"labels": schema.ListNestedAttribute{
				Optional:            true,
				MarkdownDescription: "List that contains the key-value pairs for tagging and categorizing the MongoDB database user. The labels that you define do not appear in the console.",
				CustomType:          customtypes.NewNestedListType[TFLabelsModel](ctx),
				NestedObject: schema.NestedAttributeObject{
					Attributes: map[string]schema.Attribute{
						"key": schema.StringAttribute{
							Optional:            true,
							MarkdownDescription: "Key applied to tag and categorize this component.",
						},
						"value": schema.StringAttribute{
							Optional:            true,
							MarkdownDescription: "Value set to the Key applied to tag and categorize this component.",
						},
					},
				},
			},
			"ldap_auth_type": schema.StringAttribute{
				Computed:            true,
				Optional:            true,
				MarkdownDescription: "Part of the Lightweight Directory Access Protocol (LDAP) record that the database uses to authenticate this database user on the LDAP host.",
			},
			"oidc_auth_type": schema.StringAttribute{
				Computed:            true,
				Optional:            true,
				MarkdownDescription: "Human-readable label that indicates whether the new database user or group authenticates with OIDC federated authentication. To create a federated authentication user, specify the value of USER in this field. To create a federated authentication group, specify the value of IDP_GROUP in this field.",
			},
			"password": schema.StringAttribute{
				Optional:            true,
				MarkdownDescription: "Alphanumeric string that authenticates this database user against the database specified in `databaseName`. To authenticate with SCRAM-SHA, you must specify this parameter. This parameter doesn't appear in this response.",
				Sensitive:           true,
			},
			"roles": schema.ListNestedAttribute{
				Optional:            true,
				MarkdownDescription: "List that provides the pairings of one role with one applicable database.",
				CustomType:          customtypes.NewNestedListType[TFRolesModel](ctx),
				NestedObject: schema.NestedAttributeObject{
					Attributes: map[string]schema.Attribute{
						"collection_name": schema.StringAttribute{
							Optional:            true,
							MarkdownDescription: "Collection on which this role applies.",
						},
						"database_name": schema.StringAttribute{
							Required:            true,
							MarkdownDescription: "Database to which the user is granted access privileges.",
						},
						"role_name": schema.StringAttribute{
							Required:            true,
							MarkdownDescription: "Human-readable label that identifies a group of privileges assigned to a database user. This value can either be a built-in role or a custom role.",
						},
					},
				},
			},
			"scopes": schema.ListNestedAttribute{
				Optional:            true,
				MarkdownDescription: "List that contains clusters, MongoDB Atlas Data Lakes, and MongoDB Atlas Streams Instances that this database user can access. If omitted, MongoDB Cloud grants the database user access to all the clusters, MongoDB Atlas Data Lakes, and MongoDB Atlas Streams Instances in the project.",
				CustomType:          customtypes.NewNestedListType[TFScopesModel](ctx),
				NestedObject: schema.NestedAttributeObject{
					Attributes: map[string]schema.Attribute{
						"name": schema.StringAttribute{
							Required:            true,
							MarkdownDescription: "Human-readable label that identifies the cluster or MongoDB Atlas Data Lake that this database user can access.",
						},
						"type": schema.StringAttribute{
							Required:            true,
							MarkdownDescription: "Category of resource that this database user can access.",
						},
					},
				},
			},
			"username": schema.StringAttribute{
				Required:            true,
				MarkdownDescription: "Human-readable label that represents the user that authenticates to MongoDB. The format of this label depends on the method of authentication:\n\n| Authentication Method | Parameter Needed | Parameter Value | username Format |\n|---|---|---|---|\n| AWS IAM | awsIAMType | ROLE | <abbr title=\"Amazon Resource Name\">ARN</abbr> |\n| AWS IAM | awsIAMType | USER | <abbr title=\"Amazon Resource Name\">ARN</abbr> |\n| x.509 | x509Type | CUSTOMER | [RFC 2253](https://tools.ietf.org/html/2253) Distinguished Name |\n| x.509 | x509Type | MANAGED | [RFC 2253](https://tools.ietf.org/html/2253) Distinguished Name |\n| LDAP | ldapAuthType | USER | [RFC 2253](https://tools.ietf.org/html/2253) Distinguished Name |\n| LDAP | ldapAuthType | GROUP | [RFC 2253](https://tools.ietf.org/html/2253) Distinguished Name |\n| OIDC Workforce | oidcAuthType | IDP_GROUP | Atlas OIDC IdP ID (found in federation settings), followed by a '/', followed by the IdP group name |\n| OIDC Workload | oidcAuthType | USER | Atlas OIDC IdP ID (found in federation settings), followed by a '/', followed by the IdP user name |\n| SCRAM-SHA | awsIAMType, x509Type, ldapAuthType, oidcAuthType | NONE | Alphanumeric string |\n",
			},
			"x509type": schema.StringAttribute{
				Computed:            true,
				Optional:            true,
				MarkdownDescription: "X.509 method that MongoDB Cloud uses to authenticate the database user.\n\n- For application-managed X.509, specify `MANAGED`.\n- For self-managed X.509, specify `CUSTOMER`.\n\nUsers created with the `CUSTOMER` method require a Common Name (CN) in the **username** parameter. You must create externally authenticated users on the `$external` database.",
			},
		},
	}
}

type TFModel struct {
	AwsIAMType      types.String                               `tfsdk:"aws_iamtype"`
	DatabaseName    types.String                               `tfsdk:"database_name"`
	DeleteAfterDate types.String                               `tfsdk:"delete_after_date"`
	Description     types.String                               `tfsdk:"description" autogen:"includenullonupdate"`
	GroupId         types.String                               `tfsdk:"group_id"`
	Labels          customtypes.NestedListValue[TFLabelsModel] `tfsdk:"labels"`
	LdapAuthType    types.String                               `tfsdk:"ldap_auth_type"`
	OidcAuthType    types.String                               `tfsdk:"oidc_auth_type"`
	Password        types.String                               `tfsdk:"password"`
	Roles           customtypes.NestedListValue[TFRolesModel]  `tfsdk:"roles"`
	Scopes          customtypes.NestedListValue[TFScopesModel] `tfsdk:"scopes"`
	Username        types.String                               `tfsdk:"username"`
	X509Type        types.String                               `tfsdk:"x509type"`
}
type TFLabelsModel struct {
	Key   types.String `tfsdk:"key"`
	Value types.String `tfsdk:"value"`
}
type TFRolesModel struct {
	CollectionName types.String `tfsdk:"collection_name"`
	DatabaseName   types.String `tfsdk:"database_name"`
	RoleName       types.String `tfsdk:"role_name"`
}
type TFScopesModel struct {
	Name types.String `tfsdk:"name"`
	Type types.String `tfsdk:"type"`
}
