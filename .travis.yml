language: go

go:
  - 1.14.x
  - tip

matrix:
  fast_finish: true
  allow_failures:
    - go: tip
  include:
    - name: "Code Lint"
      before_install: make tools
      script: make lint
    - name: "Website"
      before_install: make tools
      script:
        #- make website-test #commented until Terraform Provider Program Validation
        - make website-lint
    - name: "Test"
      script:
        - make test
    - name: "Acceptances test"
      before_script:
        # Ping stdout every 9 minutes or Travis kills build,
        # as travis_wait does not show the command output while processing.
        # https://docs.travis-ci.com/user/common-build-problems/#build-times-out-because-no-output-was-received
        - |
          while sleep 9m; do
              echo "====[ $SECONDS seconds still running ]===="
          done &
      script:
        - if [[ $TRAVIS_PULL_REQUEST == “false” ]] && [[ $TRAVIS_BRANCH == “master” ]]; then make testacc; fi
        - if [[ $TRAVIS_PULL_REQUEST != “false” ]]; then make testacc; fi